<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
<title>Jerome Bustarga - Portfolio</title>
<link rel="icon" type="image/png" href="images/favicon.png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>

<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
}

html {
  scroll-behavior: smooth;
  -webkit-text-size-adjust: 100%;
}

body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  background: #0d0d0d;
  color: #e8e8e8;
  line-height: 1.6;
  min-height: 100vh;
  min-height: 100dvh;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ========================================
   MOBILE LAYOUT (Default - Mobile First)
   ======================================== */

/* Mobile Header */
.mobile-header {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 20px;
  background: linear-gradient(to bottom, rgba(13, 13, 13, 1) 0%, rgba(13, 13, 13, 0.95) 100%);
  position: sticky;
  top: 0;
  z-index: 100;
  border-bottom: 1px solid rgba(244, 121, 33, 0.15);
}

.mobile-logo {
  width: 40px;
  height: 40px;
}

.mobile-logo img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  filter: drop-shadow(0 0 20px rgba(244, 121, 33, 0.6));
}

.mobile-title {
  font-size: 18px;
  font-weight: 600;
  color: #e8e8e8;
  letter-spacing: 0.5px;
}

/* Mobile Navigation */
.mobile-nav {
  display: block;
  padding: 20px;
  padding-bottom: 40px;
}

.nav-section {
  margin-bottom: 32px;
}

.nav-section-title {
  font-size: 11px;
  font-weight: 600;
  color: rgba(244, 121, 33, 0.7);
  text-transform: uppercase;
  letter-spacing: 2px;
  margin-bottom: 16px;
  padding-left: 4px;
}

.nav-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
}

.nav-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 10px;
  padding: 24px 16px;
  background: rgba(244, 121, 33, 0.08);
  border: 1px solid rgba(244, 121, 33, 0.25);
  border-radius: 12px;
  text-decoration: none;
  color: #e8e8e8;
  transition: all 0.3s ease;
}

.nav-btn:active {
  background: rgba(244, 121, 33, 0.2);
  border-color: rgba(244, 121, 33, 0.5);
  transform: scale(0.98);
}

.nav-btn-icon {
  font-size: 28px;
  color: #f47921;
}

.nav-btn-label {
  font-size: 13px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1px;
}

/* Full width button variant */
.nav-btn.full-width {
  grid-column: span 2;
  flex-direction: row;
  justify-content: flex-start;
  gap: 16px;
  padding: 20px 24px;
}

.nav-btn.full-width .nav-btn-icon {
  font-size: 24px;
}

.nav-btn.full-width .nav-btn-label {
  font-size: 14px;
}

/* Mobile Footer */
.mobile-footer {
  display: block;
  text-align: center;
  padding: 24px 20px;
  font-size: 11px;
  color: rgba(244, 121, 33, 0.4);
  letter-spacing: 1px;
  border-top: 1px solid rgba(244, 121, 33, 0.1);
}

/* ========================================
   MOBILE RESPONSIVE BREAKPOINTS
   ======================================== */

/* Small phones (480px) */
@media (max-width: 480px) {
  .mobile-header {
    padding: 16px;
    gap: 10px;
  }
  
  .mobile-logo {
    width: 35px;
    height: 35px;
  }
  
  .mobile-title {
    font-size: 16px;
  }
  
  .mobile-nav {
    padding: 16px;
  }
  
  .nav-section {
    margin-bottom: 24px;
  }
  
  .nav-section-title {
    font-size: 10px;
    margin-bottom: 12px;
  }
  
  .nav-grid {
    gap: 10px;
  }
  
  .nav-btn {
    padding: 20px 12px;
    gap: 8px;
  }
  
  .nav-btn-icon {
    font-size: 24px;
  }
  
  .nav-btn-label {
    font-size: 11px;
  }
  
  .nav-btn.full-width {
    padding: 16px 20px;
    gap: 12px;
  }
  
  .nav-btn.full-width .nav-btn-icon {
    font-size: 20px;
  }
  
  .nav-btn.full-width .nav-btn-label {
    font-size: 12px;
  }
  
  .mobile-footer {
    padding: 20px 16px;
    font-size: 10px;
  }
}

/* Very small phones (360px) */
@media (max-width: 360px) {
  .mobile-header {
    padding: 14px 12px;
  }
  
  .mobile-logo {
    width: 32px;
    height: 32px;
  }
  
  .mobile-title {
    font-size: 15px;
  }
  
  .mobile-nav {
    padding: 14px 12px;
  }
  
  .nav-btn {
    padding: 18px 10px;
  }
  
  .nav-btn-icon {
    font-size: 22px;
  }
  
  .nav-btn-label {
    font-size: 10px;
    letter-spacing: 0.5px;
  }
}

/* Safe area insets for notched phones */
@supports (padding: max(0px)) {
  .mobile-header {
    padding-top: max(20px, env(safe-area-inset-top));
    padding-left: max(20px, env(safe-area-inset-left));
    padding-right: max(20px, env(safe-area-inset-right));
  }
  
  .mobile-nav {
    padding-left: max(20px, env(safe-area-inset-left));
    padding-right: max(20px, env(safe-area-inset-right));
  }
  
  .mobile-footer {
    padding-bottom: max(24px, calc(24px + env(safe-area-inset-bottom)));
    padding-left: max(20px, env(safe-area-inset-left));
    padding-right: max(20px, env(safe-area-inset-right));
  }
}

/* Touch device optimizations */
@media (hover: none) and (pointer: coarse) {
  .nav-btn {
    min-height: 70px; /* Good touch target */
  }
  
  .nav-btn:hover {
    background: rgba(244, 121, 33, 0.08);
    border-color: rgba(244, 121, 33, 0.25);
  }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  * {
    transition-duration: 0.01ms !important;
    animation-duration: 0.01ms !important;
  }
}

/* Focus states for accessibility */
.nav-btn:focus-visible {
  outline: 2px solid #f47921;
  outline-offset: 2px;
}

.start-button:focus-visible {
  outline: 2px solid #f47921;
  outline-offset: 2px;
}

/* ========================================
   DESKTOP LAYOUT (Game Mode)
   ======================================== */

@media (min-width: 769px) {
  body {
    overflow: hidden;
    touch-action: none;
    position: fixed;
    width: 100%;
    height: 100%;
  }

  /* Hide mobile elements on desktop */
  .mobile-header,
  .mobile-nav,
  .mobile-footer {
    display: none !important;
  }

  /* Show desktop game elements */
  .lightbulb-container {
    display: flex !important;
  }
  
  #gameContainer {
    display: none !important;
  }
  
  body.power-on #gameContainer {
    display: flex !important;
  }
  
  .desktop-footer {
    display: none !important;
  }
  
  body.power-on .desktop-footer {
    display: block !important;
  }
}

/* Hide desktop elements on mobile */
@media (max-width: 768px) {
  .lightbulb-container,
  #gameContainer,
  .desktop-footer {
    display: none !important;
  }

  .mobile-header,
  .mobile-nav,
  .mobile-footer {
    display: block !important;
  }
  
  body.power-on {
    overflow: auto;
    position: static;
  }
}

/* ========================================
   DESKTOP GAME STYLES
   ======================================== */

/* Lightbulb Power Button */
.lightbulb-container {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 10000;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20px;
}

body.power-on .lightbulb-container {
  top: 40px;
  left: 60px;
  transform: translate(0, 0);
  z-index: 10001;
  flex-direction: row;
  gap: 15px;
}

.logo-wrapper {
  display: none;
  align-items: center;
  gap: 10px;
}

body.power-on .logo-wrapper {
  display: flex;
}

.lightbulb {
  width: 50px;
  height: 50px;
  position: relative;
}

.bulb-image {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

.bulb-off {
  display: block;
}

.bulb-on {
  display: none;
  filter: drop-shadow(0 0 40px rgba(244, 121, 33, 0.8)) drop-shadow(0 0 80px rgba(244, 121, 33, 0.5));
}

body.power-on .bulb-off {
  display: none;
}

body.power-on .bulb-on {
  display: block;
}

.logo-name {
  font-size: 20px;
  font-weight: 600;
  color: #e8e8e8;
  letter-spacing: 1px;
  white-space: nowrap;
}

.start-button {
  padding: 16px 50px;
  background: rgba(244, 121, 33, 0.1);
  border: 2px solid rgba(244, 121, 33, 0.4);
  color: #f47921;
  font-size: 18px;
  font-weight: 600;
  letter-spacing: 2px;
  text-transform: uppercase;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
}

.start-button:hover {
  background: rgba(244, 121, 33, 0.2);
  border-color: rgba(244, 121, 33, 0.6);
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(244, 121, 33, 0.3);
}

.start-button:active {
  transform: scale(0.98);
}

body.power-on .start-button {
  display: none;
}

#gameContainer {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 2;
  padding: 10px;
}

#gameContainer.hide-cursor,
#gameContainer.hide-cursor * {
  cursor: none !important;
}

.game-arena {
  position: relative;
  width: 100%;
  max-width: 1200px;
  height: 100%;
  max-height: 70vh;
  background: rgba(20, 20, 20, 0.6);
  border: 2px solid rgba(244, 121, 33, 0.2);
  border-radius: 20px;
  backdrop-filter: blur(20px);
  overflow: hidden;
  box-shadow: 0 0 60px rgba(244, 121, 33, 0.1);
  pointer-events: none;
}

.character {
  position: absolute;
  width: 40px;
  height: 60px;
  transition: none;
  z-index: 100;
}

/* MAIN LEVEL - GRID BASED PLATFORMER */
.main-level {
  width: 100%;
  height: 100%;
  display: none;
}

.main-level.active {
  display: grid;
  grid-template-columns: repeat(30, 1fr);
  grid-template-rows: repeat(20, 1fr);
  gap: 1px;
  background: rgba(244, 121, 33, 0.1);
}

.main-grid-cell {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid rgba(244, 121, 33, 0.15);
}

.main-grid-cell.wall {
  background: linear-gradient(135deg, #f47921, #d96a1a);
  border: 1px solid #c25a15;
  box-shadow: inset 0 0.5px 1px rgba(255, 255, 255, 0.2),
              inset 0 -0.5px 1px rgba(0, 0, 0, 0.3);
  z-index: 1;
}

.main-grid-cell.path {
  background: transparent;
  border: none;
}

/* Doors */
.door {
  position: absolute;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  gap: 12px;
  pointer-events: none;
  z-index: 50;
}

.door-icon {
  font-size: 52px;
  color: #f47921;
  transition: all 0.3s ease;
  line-height: 1;
}

.door.can-enter .door-icon {
  text-shadow: 0 0 30px rgba(244, 121, 33, 0.8),
               0 0 60px rgba(244, 121, 33, 0.6),
               0 0 90px rgba(244, 121, 33, 0.4);
  animation: iconPulse 0.8s ease-in-out infinite;
}

@keyframes iconPulse {
  0%, 100% {
    text-shadow: 0 0 30px rgba(244, 121, 33, 0.8),
                 0 0 60px rgba(244, 121, 33, 0.6),
                 0 0 90px rgba(244, 121, 33, 0.4);
  }
  50% {
    text-shadow: 0 0 40px rgba(244, 121, 33, 1),
                 0 0 80px rgba(244, 121, 33, 0.8),
                 0 0 120px rgba(244, 121, 33, 0.6);
  }
}

.door-label {
  font-size: 11px;
  font-weight: 600;
  color: #f47921;
  text-transform: uppercase;
  letter-spacing: 1.2px;
  white-space: nowrap;
  line-height: 1;
  transition: all 0.3s ease;
}

.door.can-enter .door-label {
  text-shadow: 0 0 10px rgba(244, 121, 33, 0.6);
}

/* STUDIO LEVEL - GRID BASED MAZE */
.studio-level {
  display: none;
  width: 100%;
  height: 100%;
}

.studio-level.active {
  display: grid;
  grid-template-columns: repeat(30, 1fr);
  grid-template-rows: repeat(20, 1fr);
  gap: 1px;
  background: rgba(244, 121, 33, 0.1);
}

.grid-cell {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid rgba(244, 121, 33, 0.15);
}

.grid-cell.wall {
  background: linear-gradient(135deg, #f47921, #d96a1a);
  border: 1px solid #c25a15;
  box-shadow: inset 0 0.5px 1px rgba(255, 255, 255, 0.2),
              inset 0 -0.5px 1px rgba(0, 0, 0, 0.3);
  z-index: 1;
}

.grid-cell.path {
  background: transparent;
  border: none;
}

/* Studio Doors */
.studio-door {
  position: absolute;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  gap: 12px;
  pointer-events: none;
  z-index: 50;
}

.studio-door-icon {
  font-size: 52px;
  color: #f47921;
  transition: all 0.3s ease;
  line-height: 1;
}

.studio-door.can-enter .studio-door-icon {
  text-shadow: 0 0 30px rgba(244, 121, 33, 0.8),
               0 0 60px rgba(244, 121, 33, 0.6),
               0 0 90px rgba(244, 121, 33, 0.4);
  animation: iconPulse 0.8s ease-in-out infinite;
}

.studio-door-label {
  font-size: 11px;
  font-weight: 600;
  color: #f47921;
  text-transform: uppercase;
  letter-spacing: 1.2px;
  white-space: nowrap;
  line-height: 1;
}

.studio-door.can-enter .studio-door-label {
  text-shadow: 0 0 10px rgba(244, 121, 33, 0.6);
}

.game-instructions {
  position: fixed;
  bottom: 40px;
  left: 50%;
  transform: translateX(-50%);
  text-align: center;
  color: rgba(244, 121, 33, 0.7);
  font-size: 14px;
  letter-spacing: 1px;
  animation: fadeOutInstructions 4s ease-in-out forwards;
  z-index: 10003;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
  background: rgba(13, 13, 13, 0.9);
  padding: 8px 16px;
  border-radius: 8px;
}

@keyframes fadeOutInstructions {
  0% { opacity: 1; }
  75% { opacity: 1; }
  100% { opacity: 0; visibility: hidden; }
}

.key-hint {
  display: inline-block;
  background: rgba(244, 121, 33, 0.15);
  border: 1px solid rgba(244, 121, 33, 0.4);
  padding: 4px 10px;
  border-radius: 4px;
  margin: 0 2px;
  font-family: 'Courier New', monospace;
  font-weight: 600;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.entrance-prompt {
  position: absolute;
  top: -40px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(244, 121, 33, 0.95);
  color: #0d0d0d;
  padding: 6px 12px;
  border-radius: 4px;
  font-size: 11px;
  font-weight: 600;
  letter-spacing: 1px;
  white-space: nowrap;
  opacity: 0;
  transition: opacity 0.3s ease;
  pointer-events: none;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
  z-index: 60;
}

.door.can-enter .entrance-prompt,
.studio-door.can-enter .entrance-prompt {
  opacity: 1;
  animation: bounce 0.6s ease-in-out infinite;
}

@keyframes bounce {
  0%, 100% { transform: translate(-50%, 0); }
  50% { transform: translate(-50%, -8px); }
}

/* Level indicator */
.level-indicator {
  position: fixed;
  top: 40px;
  right: 60px;
  background: rgba(244, 121, 33, 0.15);
  border: 1px solid rgba(244, 121, 33, 0.3);
  padding: 6px 14px;
  border-radius: 20px;
  font-size: 12px;
  color: #f47921;
  text-transform: uppercase;
  letter-spacing: 1px;
  z-index: 100;
}

.desktop-footer {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 10002;
  font-size: 12px;
  color: rgba(244, 121, 33, 0.5);
  letter-spacing: 1px;
  display: none;
}
</style>
</head>
<body>

<!-- ========================================
     MOBILE LAYOUT
     ======================================== -->

<header class="mobile-header">
  <div class="mobile-logo">
    <img src="images/logo.png" alt="Jerome Bustarga Logo">
  </div>
  <h1 class="mobile-title">Jerome Bustarga</h1>
</header>

<nav class="mobile-nav">
  <section class="nav-section">
    <h2 class="nav-section-title">Main</h2>
    <div class="nav-grid">
      <a href="index2.html" class="nav-btn">
        <i class="fa-solid fa-home nav-btn-icon"></i>
        <span class="nav-btn-label">Home</span>
      </a>
      <a href="about.html" class="nav-btn">
        <i class="fa-solid fa-user-circle nav-btn-icon"></i>
        <span class="nav-btn-label">About</span>
      </a>
      <a href="repository.html" class="nav-btn full-width">
        <i class="fa-solid fa-door-open nav-btn-icon"></i>
        <span class="nav-btn-label">Repository</span>
      </a>
    </div>
  </section>

  <section class="nav-section">
    <h2 class="nav-section-title">Studio</h2>
    <div class="nav-grid">
      <a href="film.html" class="nav-btn">
        <i class="fa-solid fa-film nav-btn-icon"></i>
        <span class="nav-btn-label">Film</span>
      </a>
      <a href="logobranding.html" class="nav-btn">
        <i class="fa-solid fa-tag nav-btn-icon"></i>
        <span class="nav-btn-label">Branding</span>
      </a>
      <a href="illustrations.html" class="nav-btn">
        <i class="fa-solid fa-palette nav-btn-icon"></i>
        <span class="nav-btn-label">Illustrations</span>
      </a>
      <a href="3d-art.html" class="nav-btn">
        <i class="fa-solid fa-cube nav-btn-icon"></i>
        <span class="nav-btn-label">3D Art</span>
      </a>
      <a href="webdesign.html" class="nav-btn full-width">
        <i class="fa-solid fa-code nav-btn-icon"></i>
        <span class="nav-btn-label">Web Design</span>
      </a>
    </div>
  </section>
</nav>

<footer class="mobile-footer">
  © 2025 Jerome Bustarga. All rights reserved.
</footer>


<!-- ========================================
     DESKTOP GAME LAYOUT
     ======================================== -->

<div class="lightbulb-container" id="lightbulbContainer">
  <div class="logo-wrapper">
    <div class="lightbulb" id="lightbulb">
      <img src="logo-off.png" alt="Logo Off" class="bulb-image bulb-off" id="bulbOff">
      <img src="images/logo.png" alt="Logo On" class="bulb-image bulb-on" id="bulbOn">
    </div>
    <div class="logo-name">Jerome Bustarga</div>
  </div>
  <button class="start-button" id="startButton">Start</button>
</div>

<div id="gameContainer">
  <div class="game-arena" id="gameArena">
    <div class="level-indicator" id="levelIndicator">Main Hub</div>
    
    <div class="character" id="character">
      <canvas id="characterCanvas" width="40" height="60"></canvas>
    </div>

    <!-- MAIN LEVEL - GRID PLATFORMER -->
    <div class="main-level" id="mainLevel"></div>

    <!-- STUDIO LEVEL - GRID MAZE -->
    <div class="studio-level" id="studioLevel"></div>
  </div>
</div>

<footer class="desktop-footer">
  © 2025 Jerome Bustarga. All rights reserved.
</footer>

<script>
// Only run game code on desktop
const isDesktop = window.innerWidth >= 769;

if (isDesktop) {
  const lightbulbContainer = document.getElementById('lightbulbContainer');
  const startButton = document.getElementById('startButton');
  const levelIndicator = document.getElementById('levelIndicator');
  let isPoweredOn = false;

  startButton.addEventListener('click', () => {
    if (!isPoweredOn) {
      isPoweredOn = true;
      document.body.classList.add('power-on');
      
      // Show instructions
      const instructions = document.createElement('div');
      instructions.className = 'game-instructions';
      instructions.id = 'gameInstructions';
      instructions.innerHTML = `
        Use <span class="key-hint">←</span> <span class="key-hint">→</span> to move • <span class="key-hint">↑</span> to jump • <span class="key-hint">SPACE</span> to enter doors
      `;
      document.body.appendChild(instructions);
      
      requestAnimationFrame(() => {
        const arenaRect = gameArena.getBoundingClientRect();
        const cellWidth = arenaRect.width / 30;
        const cellHeight = arenaRect.height / 20;
        
        charX = (cellWidth * 15) - 20;
        charY = (cellHeight * 10) - 30;
        
        character.style.left = charX + 'px';
        character.style.top = charY + 'px';
        
        isGrounded = false;
        velocityY = 0;
        physicsActive = true;
      });
    }
  });

  const gameContainer = document.getElementById('gameContainer');

  document.addEventListener('mousemove', (e) => {
    if (!isPoweredOn) return;
    
    const rect = gameContainer.getBoundingClientRect();
    const isInside = (
      e.clientX >= rect.left &&
      e.clientX <= rect.right &&
      e.clientY >= rect.top &&
      e.clientY <= rect.bottom
    );
    
    if (isInside) {
      gameContainer.classList.add('hide-cursor');
    } else {
      gameContainer.classList.remove('hide-cursor');
    }
  });

  const charCanvas = document.getElementById('characterCanvas');
  const charCtx = charCanvas.getContext('2d');

  function drawCharacter() {
    charCtx.clearRect(0, 0, 40, 60);
    charCtx.fillStyle = '#f47921';
    charCtx.fillRect(12, 8, 16, 16);
    charCtx.fillStyle = '#0d0d0d';
    charCtx.fillRect(15, 13, 4, 4);
    charCtx.fillRect(21, 13, 4, 4);
    charCtx.fillStyle = '#e8e8e8';
    charCtx.fillRect(10, 24, 20, 20);
    charCtx.fillStyle = '#f47921';
    charCtx.fillRect(10, 30, 20, 4);
    charCtx.fillStyle = '#a0a0a0';
    charCtx.fillRect(12, 44, 6, 12);
    charCtx.fillRect(22, 44, 6, 12);
  }

  drawCharacter();

  const character = document.getElementById('character');
  const gameArena = document.getElementById('gameArena');
  const mainLevel = document.getElementById('mainLevel');
  const studioLevel = document.getElementById('studioLevel');

  let charX = 100;
  let charY = 100;
  let velocityX = 0;
  let velocityY = 0;
  let isGrounded = false;
  let currentLevel = 'main';
  let physicsActive = false;

  const GRAVITY = 0.6;
  const JUMP_FORCE = -14;
  const MOVE_SPEED = 5;
  const MAX_FALL_SPEED = 12;

  const keys = {
    ArrowLeft: false,
    ArrowRight: false,
    ArrowUp: false,
    ArrowDown: false,
    Space: false
  };

  // Main level grid layout
  const mainLevelGrid = [];

  for (let row = 0; row < 20; row++) {
    mainLevelGrid[row] = [];
    for (let col = 0; col < 30; col++) {
      if (row === 0 || row === 19 || col === 0 || col === 29) {
        mainLevelGrid[row][col] = 1;
      }
      else if (row >= 17) {
        mainLevelGrid[row][col] = 1;
      }
      else if (col >= 3 && col <= 9 && row === 14) {
        mainLevelGrid[row][col] = 1;
      }
      else if (col >= 5 && col <= 11 && row === 10) {
        mainLevelGrid[row][col] = 1;
      }
      else if (col >= 20 && col <= 26 && row === 14) {
        mainLevelGrid[row][col] = 1;
      }
      else if (col >= 18 && col <= 24 && row === 10) {
        mainLevelGrid[row][col] = 1;
      }
      else if (col >= 13 && col <= 16 && row === 6) {
        mainLevelGrid[row][col] = 1;
      }
      else if (col >= 12 && col <= 17 && row === 13) {
        mainLevelGrid[row][col] = 1;
      }
      else {
        mainLevelGrid[row][col] = 0;
      }
    }
  }

  const mainDoorData = [
    { row: 12, col: 6, id: 'doorRepository', icon: 'fa-door-open', label: 'Repository', type: 'repository' },
    { row: 8, col: 21, id: 'doorStudio', icon: 'fa-door-open', label: 'Studio', type: 'studio' },
    { row: 4, col: 14, id: 'doorHome', icon: 'fa-door-closed', label: 'Home', type: 'home' },
    { row: 12, col: 23, id: 'doorAbout', icon: 'fa-user-circle', label: 'About', type: 'about' }
  ];

  const studioMazeGrid = [];

  for (let row = 0; row < 20; row++) {
    studioMazeGrid[row] = [];
    for (let col = 0; col < 30; col++) {
      if (row === 0 || row === 19 || col === 0 || col === 29) {
        studioMazeGrid[row][col] = 1;
      }
      else if ((col === 7 || col === 15 || col === 22) && (row < 6 || (row > 9 && row < 13) || row > 16)) {
        studioMazeGrid[row][col] = 1;
      }
      else if ((row === 7 || row === 14) && (col < 6 || (col > 9 && col < 14) || (col > 17 && col < 21) || col > 24)) {
        studioMazeGrid[row][col] = 1;
      }
      else {
        studioMazeGrid[row][col] = 0;
      }
    }
  }

  const studioDoorData = [
    { row: 4, col: 4, id: 'doorIllustrations', icon: 'fa-palette', label: 'Illustrations', type: 'illustrations' },
    { row: 11, col: 11, id: 'doorBranding', icon: 'fa-tag', label: 'Branding', type: 'branding' },
    { row: 4, col: 19, id: 'door3DArt', icon: 'fa-cube', label: '3D Art', type: '3dart' },
    { row: 4, col: 26, id: 'doorWebdesign', icon: 'fa-code', label: 'Web Design', type: 'webdesign' },
    { row: 4, col: 11, id: 'doorFilm', icon: 'fa-film', label: 'Film', type: 'film' },
    { row: 11, col: 19, id: 'doorBack', icon: 'fa-arrow-left', label: 'Back', type: 'back' }
  ];

  function buildMainGrid() {
    mainLevel.innerHTML = '';
    
    for (let row = 0; row < mainLevelGrid.length; row++) {
      for (let col = 0; col < mainLevelGrid[row].length; col++) {
        const cell = document.createElement('div');
        cell.className = 'main-grid-cell';
        cell.dataset.row = row;
        cell.dataset.col = col;
        
        if (mainLevelGrid[row][col] === 1) {
          cell.classList.add('wall');
        } else {
          cell.classList.add('path');
        }
        
        const doorInfo = mainDoorData.find(d => d.row === row && d.col === col);
        if (doorInfo) {
          const door = document.createElement('div');
          door.className = 'door';
          door.id = doorInfo.id;
          door.dataset.type = doorInfo.type;
          
          const prompt = document.createElement('div');
          prompt.className = 'entrance-prompt';
          prompt.textContent = 'Press SPACE';
          
          const icon = document.createElement('div');
          icon.className = 'door-icon';
          icon.innerHTML = `<i class="fa-solid ${doorInfo.icon}"></i>`;
          
          const label = document.createElement('div');
          label.className = 'door-label';
          label.textContent = doorInfo.label;
          
          door.appendChild(prompt);
          door.appendChild(icon);
          door.appendChild(label);
          cell.appendChild(door);
        }
        
        mainLevel.appendChild(cell);
      }
    }
  }

  function buildStudioGrid() {
    studioLevel.innerHTML = '';
    
    for (let row = 0; row < studioMazeGrid.length; row++) {
      for (let col = 0; col < studioMazeGrid[row].length; col++) {
        const cell = document.createElement('div');
        cell.className = 'grid-cell';
        cell.dataset.row = row;
        cell.dataset.col = col;
        
        if (studioMazeGrid[row][col] === 1) {
          cell.classList.add('wall');
        } else {
          cell.classList.add('path');
        }
        
        const doorInfo = studioDoorData.find(d => d.row === row && d.col === col);
        if (doorInfo) {
          const door = document.createElement('div');
          door.className = 'studio-door';
          door.id = doorInfo.id;
          door.dataset.type = doorInfo.type;
          
          const prompt = document.createElement('div');
          prompt.className = 'entrance-prompt';
          prompt.textContent = 'Press SPACE';
          
          const icon = document.createElement('div');
          icon.className = 'studio-door-icon';
          icon.innerHTML = `<i class="fa-solid ${doorInfo.icon}"></i>`;
          
          const label = document.createElement('div');
          label.className = 'studio-door-label';
          label.textContent = doorInfo.label;
          
          door.appendChild(prompt);
          door.appendChild(icon);
          door.appendChild(label);
          cell.appendChild(door);
        }
        
        studioLevel.appendChild(cell);
      }
    }
  }

  buildMainGrid();
  buildStudioGrid();
  mainLevel.classList.add('active');

  function switchToStudioLevel() {
    currentLevel = 'studio';
    mainLevel.classList.remove('active');
    studioLevel.classList.add('active');
    levelIndicator.textContent = 'Studio';
    
    // Update instructions
    const existingInstructions = document.getElementById('gameInstructions');
    if (existingInstructions) existingInstructions.remove();
    const instructions = document.createElement('div');
    instructions.className = 'game-instructions';
    instructions.id = 'gameInstructions';
    instructions.innerHTML = `
      Use <span class="key-hint">←</span> <span class="key-hint">↑</span> <span class="key-hint">↓</span> <span class="key-hint">→</span> to move • <span class="key-hint">SPACE</span> to enter doors
    `;
    document.body.appendChild(instructions);
    
    velocityX = 0;
    velocityY = 0;
    isGrounded = false;
    physicsActive = false;
    
    setTimeout(() => {
      const arenaRect = gameArena.getBoundingClientRect();
      const cellWidth = arenaRect.width / 30;
      const cellHeight = arenaRect.height / 20;
      
      charX = (cellWidth * 17) + (cellWidth / 2) - 20;
      charY = (cellHeight * 11) + (cellHeight / 2) - 30;
      
      character.style.left = charX + 'px';
      character.style.top = charY + 'px';
      
      physicsActive = true;
    }, 100);
  }

  function switchToMainLevel() {
    currentLevel = 'main';
    studioLevel.classList.remove('active');
    mainLevel.classList.add('active');
    levelIndicator.textContent = 'Main Hub';
    
    // Update instructions
    const existingInstructions = document.getElementById('gameInstructions');
    if (existingInstructions) existingInstructions.remove();
    const instructions = document.createElement('div');
    instructions.className = 'game-instructions';
    instructions.id = 'gameInstructions';
    instructions.innerHTML = `
      Use <span class="key-hint">←</span> <span class="key-hint">→</span> to move • <span class="key-hint">↑</span> to jump • <span class="key-hint">SPACE</span> to enter doors
    `;
    document.body.appendChild(instructions);
    
    velocityX = 0;
    velocityY = 0;
    isGrounded = false;
    physicsActive = false;
    
    requestAnimationFrame(() => {
      const arenaRect = gameArena.getBoundingClientRect();
      const cellWidth = arenaRect.width / 30;
      const cellHeight = arenaRect.height / 20;
      
      charX = (cellWidth * 15) - 20;
      charY = (cellHeight * 10) - 30;
      
      character.style.left = charX + 'px';
      character.style.top = charY + 'px';
      
      physicsActive = true;
    });
  }

  // Keyboard controls
  window.addEventListener('keydown', (e) => {
    if (e.code in keys || e.code === 'Space') {
      e.preventDefault();
      if (e.code === 'Space') {
        keys.Space = true;
        checkDoorEntry();
      } else if (e.code === 'ArrowUp') {
        keys.ArrowUp = true;
        if (currentLevel === 'main' && isGrounded) {
          velocityY = JUMP_FORCE;
          isGrounded = false;
        }
      } else {
        keys[e.code] = true;
      }
    }
  });

  window.addEventListener('keyup', (e) => {
    if (e.code in keys || e.code === 'Space') {
      if (e.code === 'Space') {
        keys.Space = false;
      } else {
        keys[e.code] = false;
      }
    }
  });

  function getWalls() {
    if (currentLevel === 'main') {
      return Array.from(document.querySelectorAll('.main-grid-cell.wall'));
    } else {
      return Array.from(document.querySelectorAll('.grid-cell.wall'));
    }
  }

  function checkPlatformCollision(x, y, width, height) {
    const walls = getWalls();
    const arenaRect = gameArena.getBoundingClientRect();
    
    const charWidth = 40;
    const charHeight = 60;
    
    const charBox = {
      left: arenaRect.left + x,
      right: arenaRect.left + x + charWidth,
      top: arenaRect.top + y,
      bottom: arenaRect.top + y + charHeight
    };
    
    for (let wall of walls) {
      const wallRect = wall.getBoundingClientRect();
      
      if (charBox.bottom >= wallRect.top - 2 &&
          charBox.bottom <= wallRect.top + 15 &&
          charBox.right > wallRect.left + 5 &&
          charBox.left < wallRect.right - 5 &&
          velocityY >= 0) {
        return {
          collision: true,
          platformTop: wallRect.top - arenaRect.top
        };
      }
    }
    
    return { collision: false };
  }

  function isWallAt(x, y) {
    const arenaRect = gameArena.getBoundingClientRect();
    const charWidth = 40;
    const charHeight = 60;
    
    const margin = 6;
    const charBox = {
      left: arenaRect.left + x + margin,
      right: arenaRect.left + x + charWidth - margin,
      top: arenaRect.top + y + margin,
      bottom: arenaRect.top + y + charHeight - margin
    };
    
    const walls = getWalls();
    
    for (let wall of walls) {
      const wallRect = wall.getBoundingClientRect();
      
      const overlapping = !(
        charBox.right < wallRect.left ||
        charBox.left > wallRect.right ||
        charBox.bottom < wallRect.top ||
        charBox.top > wallRect.bottom
      );
      
      if (overlapping) {
        return true;
      }
    }
    
    return false;
  }

  function moveCharacter() {
    if (!isPoweredOn || !physicsActive) {
      requestAnimationFrame(moveCharacter);
      return;
    }
    
    const arenaRect = gameArena.getBoundingClientRect();
    const charWidth = 40;
    const charHeight = 60;
    
    if (currentLevel === 'main') {
      if (keys.ArrowLeft) {
        velocityX = -MOVE_SPEED;
      } else if (keys.ArrowRight) {
        velocityX = MOVE_SPEED;
      } else {
        velocityX = 0;
      }
      
      if (!isGrounded) {
        velocityY += GRAVITY;
        if (velocityY > MAX_FALL_SPEED) {
          velocityY = MAX_FALL_SPEED;
        }
      }
      
      let newX = charX + velocityX;
      let newY = charY + velocityY;
      
      if (newX < 5) newX = 5;
      if (newX > arenaRect.width - charWidth - 5) newX = arenaRect.width - charWidth - 5;
      
      if (!isWallAt(newX, charY)) {
        charX = newX;
      } else {
        velocityX = 0;
      }
      
      const collision = checkPlatformCollision(charX, newY, charWidth, charHeight);
      
      if (collision.collision) {
        charY = collision.platformTop - charHeight + 2;
        velocityY = 0;
        isGrounded = true;
      } else {
        if (!isWallAt(charX, newY)) {
          charY = newY;
          isGrounded = false;
        } else {
          if (velocityY > 0) {
            velocityY = 0;
            isGrounded = true;
          }
        }
      }
      
      if (charY > arenaRect.height - charHeight - 5) {
        charY = arenaRect.height - charHeight - 5;
        velocityY = 0;
        isGrounded = true;
      }
      
      if (isGrounded) {
        const stillOnGround = checkPlatformCollision(charX, charY + 2, charWidth, charHeight);
        if (!stillOnGround.collision && charY < arenaRect.height - charHeight - 5) {
          isGrounded = false;
        }
      }
      
    } else {
      let newX = charX;
      let newY = charY;
      const speed = 4;
      
      if (keys.ArrowLeft && charX > 5) {
        newX = charX - speed;
      }
      if (keys.ArrowRight && charX < arenaRect.width - charWidth - 5) {
        newX = charX + speed;
      }
      if (keys.ArrowUp && charY > 5) {
        newY = charY - speed;
      }
      if (keys.ArrowDown && charY < arenaRect.height - charHeight - 5) {
        newY = charY + speed;
      }
      
      if (!isWallAt(newX, charY)) {
        charX = newX;
      }
      
      if (!isWallAt(charX, newY)) {
        charY = newY;
      }
    }
    
    character.style.left = charX + 'px';
    character.style.top = charY + 'px';
    
    checkDoorCollision();
    requestAnimationFrame(moveCharacter);
  }

  function checkDoorCollision() {
    const charRect = character.getBoundingClientRect();
    
    if (currentLevel === 'main') {
      const doors = document.querySelectorAll('.door');
      doors.forEach(door => {
        updateDoorState(door, isColliding(charRect, door.getBoundingClientRect()));
      });
    } else {
      const studioDoors = document.querySelectorAll('.studio-door');
      studioDoors.forEach(door => {
        updateDoorState(door, isColliding(charRect, door.getBoundingClientRect()));
      });
    }
  }

  function updateDoorState(door, colliding) {
    if (colliding) {
      door.classList.add('can-enter');
    } else {
      door.classList.remove('can-enter');
    }
  }

  function isColliding(rect1, rect2) {
    return !(rect1.right < rect2.left || 
             rect1.left > rect2.right || 
             rect1.bottom < rect2.top || 
             rect1.top > rect2.bottom);
  }

  function checkDoorEntry() {
    let activeDoor;
    
    if (currentLevel === 'main') {
      activeDoor = document.querySelector('.door.can-enter');
    } else {
      activeDoor = document.querySelector('.studio-door.can-enter');
    }
    
    if (activeDoor) {
      const doorType = activeDoor.dataset.type;
      
      if (doorType === 'studio') {
        switchToStudioLevel();
      } else if (doorType === 'back') {
        switchToMainLevel();
      } else {
        enterDoor(doorType);
      }
    }
  }

  function enterDoor(doorType) {
    switch(doorType) {
      case 'repository':
        window.location.href = 'repository.html';
        break;
      case 'home':
        window.location.href = 'index2.html';
        break;
      case 'about':
        window.location.href = 'about.html';
        break;
      case 'illustrations':
        window.location.href = 'illustrations.html';
        break;
      case 'branding':
        window.location.href = 'logobranding.html';
        break;
      case 'webdesign':
        window.location.href = 'webdesign.html';
        break;
      case 'film':
        window.location.href = 'film.html';
        break;
      case '3dart':
        window.location.href = '3d-art.html';
        break;
    }
  }

  moveCharacter();

  // Mouse trail effect
  new p5((p) => {
    let trails = [];
    
    p.setup = () => {
      const canvas = p.createCanvas(p.windowWidth, p.windowHeight);
      canvas.position(0, 0);
      canvas.style('pointer-events', 'none');
      canvas.style('z-index', '1');
      canvas.style('position', 'fixed');
      canvas.style('top', '0');
      canvas.style('left', '0');
      p.clear();
      p.noStroke();
    };

    p.draw = () => {
      p.clear();
      
      for (let i = trails.length - 1; i >= 0; i--) {
        const point = trails[i];
        
        p.fill(255, 255, 255, point.alpha * 0.08);
        p.ellipse(point.x, point.y, point.size * 2);
        
        p.fill(255, 255, 255, point.alpha * 0.3);
        p.ellipse(point.x, point.y, point.size);
        
        point.alpha -= 3;
        point.size *= 0.96;
        if (point.alpha <= 0) trails.splice(i, 1);
      }

      const d = p.dist(p.mouseX, p.mouseY, p.pmouseX, p.pmouseY);
      if (d > 0) {
        const steps = p.max(1, d * 0.5);
        for (let i = 0; i <= steps; i++) {
          const t = i / steps;
          const x = p.lerp(p.pmouseX, p.mouseX, t);
          const y = p.lerp(p.pmouseY, p.mouseY, t);
          trails.push({
            x,
            y,
            size: p.random(6, 10),
            alpha: p.random(120, 150)
          });
        }
      }

      if (trails.length > 600) trails.splice(0, trails.length - 600);
    };

    p.windowResized = () => {
      p.resizeCanvas(p.windowWidth, p.windowHeight);
    };
  });
}
</script>
</body>
</html>